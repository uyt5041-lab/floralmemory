-- 1. Remove old user upload data
DELETE FROM import_trade_monthly_fact 
WHERE source_name = 'USER_UPLOAD' 
  AND importer_code = 'KOR' 
  AND exporter_code = 'COL' 
  AND hs_code = '060310';

-- 2. Insert new 2016-2024 data
-- Normalizing input HS Code 0603120000 -> 060310 (system default)
INSERT INTO import_trade_monthly_fact (month, importer_code, exporter_code, hs_code, product_id, quantity_kg, value_usd, source_name)
SELECT 
  TO_DATE(d.period || '.01', 'YYYY.MM.DD'), 
  'KOR', 
  'COL', 
  '060310', 
  (SELECT product_id FROM dim_product WHERE product_slug = 'carnation'),
  d.weight, 
  d.usd, 
  'USER_UPLOAD'
FROM (VALUES
  -- 2024
  ('2024.01', 146900, 1429336), ('2024.02', 112864, 1093214), ('2024.03', 119033, 1123358), 
  ('2024.04', 319947, 3463952), ('2024.05', 103593, 1035461), ('2024.06', 72515, 690176), 
  ('2024.07', 70711, 686661),   ('2024.08', 120643, 1119872), ('2024.09', 114605, 1062501), 
  ('2024.10', 156349, 1450643), ('2024.11', 135990, 1293676), ('2024.12', 163447, 1582936),
  -- 2023
  ('2023.01', 116850, 1208080), ('2023.02', 87385, 881819),   ('2023.03', 127544, 1275320), 
  ('2023.04', 322201, 3866492), ('2023.05', 107632, 1137782), ('2023.06', 66109, 657946), 
  ('2023.07', 62698, 597522),   ('2023.08', 102295, 935168),  ('2023.09', 111900, 1064836), 
  ('2023.10', 132292, 1198885), ('2023.11', 124179, 1110903), ('2023.12', 147079, 1378986),
  -- 2022
  ('2022.01', 97089, 1005039),  ('2022.02', 70960, 715251),   ('2022.03', 89743, 896119), 
  ('2022.04', 238796, 2985204), ('2022.05', 110378, 1299099), ('2022.06', 53733, 562238), 
  ('2022.07', 73037, 770113),   ('2022.08', 85840, 907271),   ('2022.09', 103578, 1106166), 
  ('2022.10', 106635, 1147695), ('2022.11', 115071, 1192174), ('2022.12', 132388, 1355556),
  -- 2021
  ('2021.01', 48868, 451865),   ('2021.02', 38003, 342957),   ('2021.03', 60451, 537268), 
  ('2021.04', 165279, 1842443), ('2021.05', 99470, 1090266),  ('2021.06', 40138, 387968), 
  ('2021.07', 46809, 435121),   ('2021.08', 56306, 518890),   ('2021.09', 68764, 656201), 
  ('2021.10', 78413, 779719),   ('2021.11', 94673, 924739),   ('2021.12', 97494, 1006396),
  -- 2020
  ('2020.01', 71239, 718332),   ('2020.02', 24928, 233658),   ('2020.03', 24525, 238918), 
  ('2020.04', 75777, 942484),   ('2020.05', 62435, 660251),   ('2020.06', 21816, 207344), 
  ('2020.07', 28267, 297915),   ('2020.08', 34898, 383879),   ('2020.09', 40523, 418165), 
  ('2020.10', 48336, 498165),   ('2020.11', 63313, 632830),   ('2020.12', 44836, 419692),
  -- 2019
  ('2019.01', 46964, 494891),   ('2019.02', 26501, 283929),   ('2019.03', 32591, 330483), 
  ('2019.04', 80740, 830879),   ('2019.05', 34142, 336052),   ('2019.06', 17016, 167533), 
  ('2019.07', 20137, 197053),   ('2019.08', 30838, 296999),   ('2019.09', 43595, 427839), 
  ('2019.10', 49402, 465298),   ('2019.11', 48575, 455475),   ('2019.12', 58907, 590915),
  -- 2018
  ('2018.01', 37452, 318628),   ('2018.02', 23359, 197469),   ('2018.03', 26909, 224955), 
  ('2018.04', 50594, 450228),   ('2018.05', 28369, 269573),   ('2018.06', 9693, 85095), 
  ('2018.07', 4348, 41749),     ('2018.08', 25183, 214834),   ('2018.09', 29870, 254489), 
  ('2018.10', 42775, 379689),   ('2018.11', 36213, 364391),   ('2018.12', 37185, 372925),
  -- 2017
  ('2017.01', 15724, 137066),   ('2017.02', 22573, 190520),   ('2017.03', 19761, 177734), 
  ('2017.04', 21998, 263040),   ('2017.05', 5626, 58791),     ('2017.06', 4435, 35257), 
  ('2017.07', 2270, 19215),     ('2017.08', 15107, 127052),   ('2017.09', 31689, 263714), 
  ('2017.10', 20640, 159494),   ('2017.11', 32454, 264647),   ('2017.12', 24649, 203292),
  -- 2016
  ('2016.01', 4280, 31692),     ('2016.02', 3803, 29656),     ('2016.03', 2733, 21335), 
  ('2016.04', 9655, 80688),     ('2016.05', 2690, 18809),     ('2016.06', 60, 500), 
  ('2016.07', 735, 5452),       ('2016.08', 4720, 40025),     ('2016.09', 13056, 107601), 
  ('2016.10', 13923, 124690),   ('2016.11', 25671, 222171),   ('2016.12', 11780, 105521)
) AS d(period, weight, usd);
